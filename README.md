#MESquare AI对话后端

## 概述

该项目是一个智能对话系统，结合了用户特征分析功能。系统不仅能与用户进行自然对话，还能分析用户提问内容，识别用户特征（情绪、喜好、目标），并在后续对话中利用这些特征提供更个性化的回答。

## 功能特点

1. **实时对话交互**：
   - 使用 DeepSeek-R1 大型语言模型进行对话
   - 支持自然语言交流
   - 输入"退出"、"exit"或"quit"结束对话

2. **用户特征分析**：
   - 自动分析用户提问内容
   - 识别用户情绪、喜好和目标
   - 生成用户特征摘要（一句话格式）

3. **对话记忆**：
   - 记录完整对话历史
   - 单独保存用户提问记录
   - 持续更新用户特征分析

## 文件说明

| 文件名 | 功能描述 |
|--------|----------|
| `ConversationAI.py` | 主对话程序，处理用户交互和日志记录 |
| `AnalyzeAI.py` | 用户特征分析程序，处理用户提问日志 |
| `user_questions.log` | 用户提问历史记录（自动生成） |
| `conversation_log.txt` | 完整对话记录（自动生成） |
| `user_characteristics.txt` | 用户特征分析结果（自动生成） |

## 安装与使用

### 前置要求

1. 安装 Python 3.7+
2. 安装 Ollama 框架：
   ```bash
   pip install ollama
   ```

### 运行步骤

1. **拉取语言模型**（首次运行前）：
   ```bash
   ollama pull deepseek-r1:1.5b
   ```

2. **启动对话系统**：
   ```bash
   python ConversationAI.py
   ```

3. **开始对话**：
   ```
   对话系统已启动(输入'退出'结束对话)
   Question: [输入您的问题]
   ```

### 操作示例
```
Question: 推荐一些适合初学者的编程语言
AI: 根据您的学习目标，我推荐Python作为初学者的首选编程语言...

Question: 我现在感觉有点沮丧
AI: 我注意到您最近情绪有些低落，也许可以尝试...

Question: 退出
对话结束
```

## 技术说明

1. **特征分析格式**：
   - 系统会生成一句话格式的用户特征摘要
   - 格式：`用户的情绪是xxx,喜好是xxx,目标是xxx`
   - 缺失的特征项会被自动省略

2. **文件编码**：
   - 用户提问日志：UTF-8
   - 特征分析结果：ANSI
   - 完整对话记录：UTF-8

3. **特征更新机制**：
   - 每次用户提问后自动更新特征分析
   - 最新特征会用于后续所有对话

## 注意事项

1. 首次运行需要下载约 1.5B 参数的模型，请确保网络畅通
2. 系统会持续追加日志内容，定期清理旧日志文件
3. 特征分析基于用户提问内容，提问越多分析越准确
4. 如需更换模型，请修改代码中的 `deepseek-r1:1.5b` 为其他可用模型

## 自定义建议

1. **调整分析频率**：  
   修改 `ConversationAI.py` 中的 `AnalyzeAI.analyze_user_questions()` 调用位置可改变特征分析频率

2. **更改模型**：  
   替换代码中的模型名称可使用其他 Ollama 支持的模型

3. **修改日志格式**：  
   编辑 `log_question` 和 `log_dialog` 函数可自定义日志格式

此系统适合用于用户研究、个性化服务开发和对话系统实验等场景。
